
#include "Fitter.cc"

int main()
{
    double energy_vector[] =
    {
        0.66201 ,0.80879    ,1.05264    ,1.21767    ,2.96445    ,2.86088    ,2.69813    ,2.48962    ,2.25152    ,
        2.00070 ,1.75268    ,1.52003    ,2.27882    ,2.60832    ,2.95748    ,3.30884    ,3.64108    ,3.93118    ,
        4.15713 ,4.30074    ,1.98127    ,1.72261    ,1.50509    ,1.50509    ,1.72261    ,1.98127    ,0.81657    ,
        0.95882 ,1.11930    ,1.29208    ,1.46825    ,1.63655    ,1.78465    ,1.90062    ,1.97458    ,0.69544    ,
        0.59575 ,0.51611    ,0.45421    ,0.38915    ,0.68765    ,0.65189    ,0.59641    ,0.48874    ,0.37184    ,
        0.26609 ,0.18371    ,0.12684    ,0.10089    ,0.07506    ,0.05996    ,0.05996    ,7.90894    ,7.64353    ,
        7.22603 ,6.69019    ,6.07682    ,5.42853    ,4.78473    ,4.17760    ,3.62976    ,3.15389    ,2.75400    ,
        2.42779
    };

    int run_vector[] =
    {
        50  ,49  ,48  ,47  ,46  ,45  ,44  ,39  ,38  ,43  ,37  ,36  ,42  ,41  ,0   ,40  ,35  ,1   ,26  ,27  ,2   ,
        28  ,3   ,29  ,30  ,22  ,23  ,11  ,31  ,21  ,24  ,10  ,32  ,33  ,34  ,20  ,25  ,9   ,8   ,12  ,63  ,7   ,
        13  ,6   ,62  ,5   ,14  ,4   ,61  ,15  ,60  ,16  ,17  ,18  ,59  ,19  ,58  ,57  ,56  ,55  ,54  ,53  ,52  
    };

    int angle_vector[] = 
    {
        145,125,105,95,10,20,30,40,50,
        60,70,80,80,70,60,50,40,30,20,
        10,90,100,110,110,100,90,90,80,
        70,60,50,40,30,20,10,100,110,120,
        130,145,10,20,30,45,60,75,90,105,
        115,130,145,145,10,20,30,40,50,
        60,70,80,90,100,110,120
    };   

    Fitter fit;

    for(int i=0; i<=63; i++) 
    {
        if(angle_vector[i]>=90) fit.SetNextNeutronFit_BC501A(i);  // backward
        //if(angle_vector[i]<=90 && angle_vector[i]>=60) fit.SetNextNeutronFit_BC501A(i);  // middle
        //if(angle_vector[i]<=60) fit.SetNextNeutronFit_BC501A(i);  // foreward 
    }

    //fit.NelderMead();

    fit.SetParameters(0.6396, 1.4635, 0.3752, 0.9682, 0);
    fit.SortAllRuns();
    fit.DrawToFile("backward.pdf");

    return 0;
}
